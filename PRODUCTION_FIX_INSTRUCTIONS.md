# üîß –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é –ø—Ä–æ–¥–∞–∫—à–µ–Ω –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

## ‚ùå –ü—Ä–æ–±–ª–µ–º–∞
–ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –¥–æ–±–∞–≤–∏—Ç—å –∞—Ä—Ç–∏–∫—É–ª –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –æ—à–∏–±–∫–∞:
```
API error: –û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞: {'code': 'PGRST204', 'details': None, 'hint': None, 'message': "Could not find the 'image_url' column of 'ozon_scraper_articles' in the schema cache"}
```

**–ü—Ä–∏—á–∏–Ω–∞:** –í –ø—Ä–æ–¥–∞–∫—à–µ–Ω –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –Ω–µ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã –º–∏–≥—Ä–∞—Ü–∏–∏ 006, 009 –∏ 010, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–±–∞–≤–ª—è—é—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∫–æ–ª–æ–Ω–∫–∏.

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### –®–∞–≥ 1: –û—Ç–∫—Ä–æ–π—Ç–µ Supabase SQL Editor

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ Supabase Dashboard: https://app.supabase.com/project/kknxajmrtexzzlqgvlxg
2. –í –ª–µ–≤–æ–º –º–µ–Ω—é –≤—ã–±–µ—Ä–∏—Ç–µ **SQL Editor**
3. –ù–∞–∂–º–∏—Ç–µ **New Query**

### –®–∞–≥ 2: –ü—Ä–∏–º–µ–Ω–∏—Ç–µ SQL —Å–∫—Ä–∏–ø—Ç

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `PRODUCTION_FIX.sql` –∏–∑ –∫–æ—Ä–Ω—è –ø—Ä–æ–µ–∫—Ç–∞
2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤–µ—Å—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞
3. –í—Å—Ç–∞–≤—å—Ç–µ –≤ SQL Editor –≤ Supabase
4. –ù–∞–∂–º–∏—Ç–µ **Run** –∏–ª–∏ **Ctrl+Enter**

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–°–∫—Ä–∏–ø—Ç –¥–æ–ª–∂–µ–Ω —É—Å–ø–µ—à–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å—Å—è –∏ –≤—ã–≤–µ—Å—Ç–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ:
```
PRODUCTION FIX: Migrations applied successfully!
Added columns:
  - normal_price, ozon_card_price, average_price_7days, price_updated_at
  - available
  - image_url, product_url, name, last_check
All indexes and constraints created.
```

### –®–∞–≥ 4: –û—á–∏—Å—Ç–∏—Ç–µ –∫—ç—à Supabase (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–π –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –æ—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞ —Å—Ö–µ–º—ã:

1. –í Supabase Dashboard –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Settings** ‚Üí **API**
2. –ù–∞–∂–º–∏—Ç–µ **Reload schema cache** –∏–ª–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç (Settings ‚Üí General ‚Üí Restart project)

### –®–∞–≥ 5: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É –±–æ—Ç–∞

–ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞ –¥–æ–±–∞–≤–∏—Ç—å –∞—Ä—Ç–∏–∫—É–ª —á–µ—Ä–µ–∑ Telegram –±–æ—Ç–∞. –û—à–∏–±–∫–∞ –¥–æ–ª–∂–Ω–∞ –∏—Å—á–µ–∑–Ω—É—Ç—å.

## üìã –ß—Ç–æ –¥–æ–±–∞–≤–ª—è–µ—Ç —Å–∫—Ä–∏–ø—Ç

### Migration 006: –î–µ—Ç–∞–ª—å–Ω—ã–µ —Ü–µ–Ω—ã
- `normal_price` - —Ü–µ–Ω–∞ –±–µ–∑ Ozon Card
- `ozon_card_price` - —Ü–µ–Ω–∞ —Å Ozon Card
- `average_price_7days` - —Å—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞ –∑–∞ 7 –¥–Ω–µ–π
- `price_updated_at` - –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ü–µ–Ω

### Migration 009: –ù–∞–ª–∏—á–∏–µ —Ç–æ–≤–∞—Ä–∞
- `available` - –¥–æ—Å—Ç—É–ø–µ–Ω –ª–∏ —Ç–æ–≤–∞—Ä –¥–ª—è –ø–æ–∫—É–ø–∫–∏ (boolean)

### Migration 010: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–æ–≤–∞—Ä–µ
- `image_url` - URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞
- `product_url` - URL —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Ç–æ–≤–∞—Ä–∞ –Ω–∞ OZON
- `name` - –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
- `last_check` - –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–π –ø—Ä–æ–≤–µ—Ä–∫–∏

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—É—â–µ–π —Å—Ö–µ–º—ã

–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –∫–∞–∫–∏–µ –∫–æ–ª–æ–Ω–∫–∏ —É–∂–µ –µ—Å—Ç—å –≤ —Ç–∞–±–ª–∏—Ü–µ, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```sql
SELECT
    column_name,
    data_type,
    is_nullable,
    column_default
FROM information_schema.columns
WHERE table_name = 'ozon_scraper_articles'
ORDER BY ordinal_position;
```

## ‚ö†Ô∏è –í–∞–∂–Ω–æ

- –°–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `IF NOT EXISTS`, –ø–æ—ç—Ç–æ–º—É –±–µ–∑–æ–ø–∞—Å–µ–Ω –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- –°–∫—Ä–∏–ø—Ç –æ–±–µ—Ä–Ω—É—Ç –≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é `BEGIN...COMMIT`, –ø–æ—ç—Ç–æ–º—É –ª–∏–±–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—Å—è –ø–æ–ª–Ω–æ—Å—Ç—å—é, –ª–∏–±–æ –æ—Ç–∫–∞—Ç–∏—Ç—Å—è
- –í—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—Ç—Å—è

## üÜò –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫

1. –°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–∫–∞—Ç–∏—Ç—Å—è –ø—Ä–∏ –æ—à–∏–±–∫–µ (ROLLBACK)
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –æ—à–∏–±–æ–∫ –≤ SQL Editor
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å –µ—Å—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
4. –°–≤—è–∂–∏—Ç–µ—Å—å —Å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º Supabase –ø—Ä–æ–µ–∫—Ç–∞

## üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã

–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –Ω–µ —Ä–µ—à–∞–µ—Ç—Å—è:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ Supabase Dashboard ‚Üí Logs
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ API endpoint: https://kknxajmrtexzzlqgvlxg.supabase.co
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ `.env` –∞–∫—Ç—É–∞–ª—å–Ω—ã

---

**–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–∞ –ø—Ä–æ–±–ª–µ–º–∞ –±—É–¥–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ—à–µ–Ω–∞!**
