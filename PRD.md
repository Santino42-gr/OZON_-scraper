Ниже предоставляю расширенный и более комплексный PRD для MVP проекта OZON Telegram-бота с админ-панелью.

***

# Product Requirements Document (PRD)  
## Проект: OZON Telegram Bot & Admin Panel (MVP + Основы масштабирования)

***

## 1. Обзор проекта

### 1.1. Цель  
Создать MVP систему для анализа и мониторинга товаров OZON, ориентированную на быстродействие, удобство интеграции и перспективу масштабирования.  
*Система состоит из Telegram-бота (Python) для работы пользователей и веб админ-панели для администрирования и просмотра аналитики.*

### 1.2. Бизнес-задача  
- Автоматизировать анализ информации по артикулам товаров OZON для магазинов и продавцов.
- Снизить нагрузку на ручной сбор данных и повысить актуальность отчетности.
- Повысить доступность информации для конечных пользователей через привычный канал (Telegram).

***

## 2. Функциональные требования

### 2.1. Основные сценарии использования  
#### Telegram-бот  
- Регистрация/привязка пользователя Telegram к системе (для внутреннего аудита)
- Добавление/удаление артикула OZON одним сообщением или командой
- Получение актуальной информации по артикулу: наличие товара, цена, статус, рейтинг, остатки, другие параметры, отражённые на OZON по каждому товару
- Просмотр истории собственных запросов
- Функция быстрой проверки нескольких артикулов списком
- Формирование основных отчетов по артикулу/артикулам, по команде /report
- Интерактивный Help для новых пользователей (автоматическое знакомство при первом запуске)

#### Админ-панель  
- Аутентификация по email/паролю (Supabase auth, возможно 2FA)
- Главный дашборд — визуализация ключевых метрик (на старте: число пользователей, кол-во добавленных артикулов, среднее число запросов, успешные/ошибочные парсинги)
- Просмотр логов работы системы: обращения к боту, сбои парсинга, периоды активности
- Управление базой артикулов: просмотр, редактирование, удаление, временная блокировка. Возможность пометить артикул “проблемным”
- Управление пользователями: просмотр, блокировка, удаление пользователей (минимальный CRUD)
- Система уведомлений для администратора (например, при массовых сбоях или подозрительных активностях)

### 2.2. Расширенные возможности (перспектива)  
- Поддержка анализа связанных показателей (например, сравнение динамики цены между артикулами)
- Мультиязычная поддержка бота и панели (RU/EN)
- Отправка email-отчетов или push-уведомлений о событиях
- Расширенная фильтрация и поиск в админ-панели

***

## 3. Нефункциональные требования

### 3.1. Технологии и архитектура  
- Backend: Python 3.10+, асинхронный фреймворк (FastAPI/Flask/Starlette)
- Telegram Bot: aiogram/pyTelegramBotAPI
- Database: Supabase (Postgres+Auth)
- Frontend: React (Vite/CRA), Supabase UI компоненты, или максимально легковесный самостоятельный интерфейс
- Интеграция с OZON: HTTP-запросы, парсинг на Selenium/JS с ротацией User-Agent и поддержкой ретраев и таймаутов (10 сек), правильное логирование ошибок

### 3.2. Масштабируемость  
- Возможность миграции к серверлесс (Supabase) или выделенному VPS  
- Масштабируемая авторизация (поддержка нескольких админов)  
- Возможность быстрого добавления новых метрик или API-интеграций

### 3.3. Безопасность  
- Надежная авторизация через Supabase Auth
- Защита панелей от неавторизованных запросов (CORS, CSRF)
- Минимизация XSS/SQL-инъекций (ORM, валидация входных данных)
- Логирование подозрительных операций

### 3.4. Отказоустойчивость и мониторинг  
- Система алертов на сбои парсинга OZON/ошибки бота (для админа панели)
- Прозрачная система логов в базе (Supabase), журналирование ошибок с метаданными
- Резервное копирование базы (режим автоматических снапшотов Supabase)

***

## 4. Пользовательский опыт и интерфейс

### 4.1. Telegram-бот  
- Упор на простоту: все команды через клавиатуру или текстовые инлайн-команды, без сложной навигации
- Хелп-меню, описание команд
- Ответы системы — лаконичные, дружелюбные и информативные
- Multi-query: возможность отправлять список артикулов в одном сообщении

### 4.2. Админ-панель  
- Вход/выход (Supabase Auth)
- Главная страница: визуальный дашборд (графики/stat-карточки — «Пользователи», «Артикулы», «Ошибки», «Успешные парсинги»)
- Разделы: “Артикулы”, “Пользователи”, “Логи”, “Настройки”
- Быстрый экспорт данных (CSV/XLSX) для отчетности

***

## 5. Хранение и работа с данными

- Таблица пользователей (userId, telegram_username, дата регистрации, статус блокировки)
- Таблица артикулов (артикул, связанный пользователь, дата добавления, статус обработки, последние параметры)
- Таблица истории запросов (userId, артикул, время запроса, результат/ошибка, первичный ответ)
- Таблица логов (тип события, сообщение, уровень, timestamp, userId/артикул)
- Таблица администраторов/прав доступа (если потребуется масштабирование)

***

## 6. Интеграции

- OZON (при необходимости обход капч и защиты через middlewares)
- Telegram (бот-api)
- Supabase (auth, storage, db)

***

## 7. Архитектурная схема (описание)

**Telegram User** <—> **Telegram Bot (Python)** <—> **API (FastAPI/Flask) + Supabase** <—> **OZON**

**Администратор** <—> **Web Admin Panel (React + Supabase Auth)** <—> **Supabase DB + API**

***

## 8. Этапы реализации (Roadmap)

1. Проектирование базы данных Supabase и API-интерфейса
2. MVP бота с основными командами (“add”, “remove”, “list”, “check”, “report”)
3. Интеграция с OZON (реализация resilient парсинга, обработка ошибок)
4. Разработка админ-панели (авторизация, главный дашборд, CRUD пользователя и артикула, логирование)
5. Документация (README, инструкции по сборке, REST API описание)
6. Тестирование: unit + интеграционное, ручной прогон команд, стабилизация на тестовой среде
7. Выкатка в прод, контроль инцидентов
8. Сбор пожеланий от пользователя/клиента, планирование расширений

***

## 9. Риски и ограничения

- Возможные блокировки/ограничения OZON по частоте запросов — реализовать резервный User-Agent, задержки и антибот-защиту
- Сложности масштабирования под большой поток (добавить rate-limiting по мере роста)
- Ограничение по обработке массовых списков артикулов из-за скорости источника данных
- Отсутствие мобильной версии панели (ограничение MVP)

***

## 10. Контроль качества и сопровождение

- Покрытие основных функций тестами (бот, api, критичные сценарии панели)
- Мониторинг uptime/ошибок админ-панели и бота
- Обратная связь от пользователей через Telegram

***

## 11. Приложения и документация к проекту

- ER-диаграмма базы (в Supabase)
- README с форматами команд Telegram-бота, вариантами ответов
- Описание маршрутов API (если панель взаимодействует через собственный API)
- Чек-лист для тестирования MVP

***

Если потребуются отдельные таблицы, графики BDD, диаграммы или образец интерфейса для панели, дай знать — подготовлю их в виде приложений к этому документу!