# –ü–ª–∞–Ω –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –∞—Ä—Ç–∏–∫—É–ª–æ–≤ (—Å–≤–æ–π + –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç)

> **–°–æ–∑–¥–∞–Ω–æ:** 2025-10-29
> **–°—Ç–∞—Ç—É—Å:** –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
> **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –í—ã—Å–æ–∫–∏–π (–æ—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª)

---

## üéØ –¶–ï–õ–¨

–î–æ–±–∞–≤–∏—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å —Å–≤–æ–π –∞—Ä—Ç–∏–∫—É–ª —Å –∞—Ä—Ç–∏–∫—É–ª–æ–º –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–∞ —Å —Ä–∞—Å—á–µ—Ç–æ–º –º–µ—Ç—Ä–∏–∫ (—Ü–µ–Ω—ã, —Ä–µ–π—Ç–∏–Ω–≥, –°–ü–ü) –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏.

### –ë–∏–∑–Ω–µ—Å-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:

1. **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–∞—Ä—ã –∞—Ä—Ç–∏–∫—É–ª–æ–≤:**
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–±–∞–≤–ª—è–µ—Ç –°–í–û–ô –∞—Ä—Ç–∏–∫—É–ª (–∫–æ—Ç–æ—Ä—ã–π –æ–Ω –ø—Ä–æ–¥–∞–µ—Ç)
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–±–∞–≤–ª—è–µ—Ç –∞—Ä—Ç–∏–∫—É–ª –ö–û–ù–ö–£–†–ï–ù–¢–ê
   - –≠—Ç–∏ –¥–≤–∞ –∞—Ä—Ç–∏–∫—É–ª–∞ —Å–≤—è–∑–∞–Ω—ã –∏ —Å—Ä–∞–≤–Ω–∏–≤–∞—é—Ç—Å—è –¥—Ä—É–≥ —Å –¥—Ä—É–≥–æ–º

2. **–°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö:**
   - –î–ª—è —Å–≤–æ–µ–≥–æ –∞—Ä—Ç–∏–∫—É–ª–∞: —Ü–µ–Ω–∞, normal_price, ozon_card_price, —Ä–µ–π—Ç–∏–Ω–≥, –æ—Å—Ç–∞—Ç–∫–∏, –°–ü–ü
   - –î–ª—è –∞—Ä—Ç–∏–∫—É–ª–∞ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–∞: —Ç–µ –∂–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
   - –ò—Å—Ç–æ—Ä–∏—è —Ü–µ–Ω –¥–ª—è –æ–±–æ–∏—Ö –∞—Ä—Ç–∏–∫—É–ª–æ–≤ (–∫–∞–∂–¥—ã–µ 24 —á–∞—Å–∞ —á–µ—Ä–µ–∑ Cron)

3. **–†–∞—Å—á–µ—Ç –º–µ—Ç—Ä–∏–∫:**
   - –°–ü–ü –¥–ª—è —Å–≤–æ–µ–≥–æ –∞—Ä—Ç–∏–∫—É–ª–∞ –∏ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–∞ (–ø–æ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º —Ñ–æ—Ä–º—É–ª–∞–º)
   - –†–∞–∑–Ω–∏—Ü–∞ –≤ —Ü–µ–Ω–∞—Ö (–∞–±—Å–æ–ª—é—Ç–Ω–∞—è –∏ –ø—Ä–æ—Ü–µ–Ω—Ç–Ω–∞—è)
   - –†–∞–∑–Ω–∏—Ü–∞ –≤ —Ä–µ–π—Ç–∏–Ω–≥–∞—Ö
   - –†–∞–∑–Ω–∏—Ü–∞ –≤ –æ—Å—Ç–∞—Ç–∫–∞—Ö
   - **–ò–Ω–¥–µ–∫—Å –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏** (0-1) —Å –≥—Ä–µ–π–¥–∞–º–∏ A-F

4. **–û—Ç—á–µ—Ç—ã:**
   - –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –æ–±–∞ –∞—Ä—Ç–∏–∫—É–ª–∞ —Ä—è–¥–æ–º –≤ –±–æ—Ç–µ
   - –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –ø–æ –≤—Å–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º
   - –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–∑–Ω–∏—Ü—ã –≤ —Ü–µ–Ω–∞—Ö
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä: "–í–∞—à–∞ —Ü–µ–Ω–∞ –≤—ã—à–µ –Ω–∞ 15%")

---

## üìã –ê–†–•–ò–¢–ï–ö–¢–£–†–ù–´–ï –†–ï–®–ï–ù–ò–Ø

### –í—ã–±—Ä–∞–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ë–î: **–í–∞—Ä–∏–∞–Ω—Ç –í - –ì–∏–±–∫–∞—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ —á–µ—Ä–µ–∑ article_groups**

**–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:**
- ‚úÖ **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å**: –ú–æ–∂–Ω–æ —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å 2+ –∞—Ä—Ç–∏–∫—É–ª–æ–≤ (–Ω–µ —Ç–æ–ª—å–∫–æ –ø–∞—Ä—ã)
- ‚úÖ **–ì–∏–±–∫–æ—Å—Ç—å**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ N-to-N —Å–≤—è–∑–µ–π (1 –∞—Ä—Ç–∏–∫—É–ª –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≥—Ä—É–ø–ø–∞—Ö)
- ‚úÖ **–†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å**: –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å —Ç–∏–ø—ã –≥—Ä—É–ø–ø (competitor, variant, similar)
- ‚úÖ **–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∞—Ä—Ç–∏–∫—É–ª—ã —Ä–∞–±–æ—Ç–∞—é—Ç –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- ‚úÖ **–ß–∏—Å—Ç–æ—Ç–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã**: –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ë–î

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**

```
ozon_scraper_article_groups
‚îú‚îÄ id (UUID)
‚îú‚îÄ user_id (UUID)
‚îú‚îÄ name (TEXT)
‚îú‚îÄ group_type (TEXT: 'comparison', 'variants', 'similar')
‚îú‚îÄ created_at
‚îî‚îÄ updated_at

ozon_scraper_article_group_members (N-to-N)
‚îú‚îÄ id (UUID)
‚îú‚îÄ group_id (UUID ‚Üí article_groups)
‚îú‚îÄ article_id (UUID ‚Üí articles)
‚îú‚îÄ role (TEXT: 'own', 'competitor', 'item')
‚îú‚îÄ position (INTEGER)
‚îî‚îÄ added_at

ozon_scraper_comparison_snapshots
‚îú‚îÄ id (UUID)
‚îú‚îÄ group_id (UUID ‚Üí article_groups)
‚îú‚îÄ snapshot_date
‚îú‚îÄ comparison_data (JSONB)
‚îú‚îÄ metrics (JSONB)
‚îú‚îÄ competitiveness_index (DECIMAL)
‚îî‚îÄ created_at
```

---

## üìã –§–ê–ó–ê 1: –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (–î–µ–Ω—å 1)

### –ó–∞–¥–∞—á–∏:

- [ ] **1.1. –°–æ–∑–¥–∞—Ç—å SQL –º–∏–≥—Ä–∞—Ü–∏—é** `backend/migrations/008_article_comparison.sql`
  - –¢–∞–±–ª–∏—Ü–∞ `ozon_scraper_article_groups` (–≥—Ä—É–ø–ø—ã —Å—Ä–∞–≤–Ω–µ–Ω–∏—è)
  - –¢–∞–±–ª–∏—Ü–∞ `ozon_scraper_article_group_members` (—Å–≤—è–∑—å N-to-N –∞—Ä—Ç–∏–∫—É–ª–æ–≤ —Å –≥—Ä—É–ø–ø–∞–º–∏)
  - –¢–∞–±–ª–∏—Ü–∞ `ozon_scraper_comparison_snapshots` (–∏—Å—Ç–æ—Ä–∏—è —Å—Ä–∞–≤–Ω–µ–Ω–∏–π)
  - –ò–Ω–¥–µ–∫—Å—ã –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
  - RLS policies –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
  - –¢—Ä–∏–≥–≥–µ—Ä—ã –¥–ª—è updated_at
  - SQL —Ñ—É–Ω–∫—Ü–∏–∏: `get_group_comparison()`, `save_comparison_snapshot()`

- [ ] **1.2. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –≤ Supabase**
  - Development: –ü—Ä–∏–º–µ–Ω–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ –¥–ª—è —Ç–µ—Å—Ç–æ–≤
  - Production: –ü—Ä–∏–º–µ–Ω–∏—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –ø–æ—Å–ª–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### SQL –ú–∏–≥—Ä–∞—Ü–∏—è (–¥–µ—Ç–∞–ª–∏):

```sql
-- =====================================================
-- Migration 008: Article Comparison Feature
-- =====================================================

BEGIN;

-- 1. –¢–∞–±–ª–∏—Ü–∞ –≥—Ä—É–ø–ø –∞—Ä—Ç–∏–∫—É–ª–æ–≤
CREATE TABLE IF NOT EXISTS ozon_scraper_article_groups (
    id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
    user_id UUID NOT NULL REFERENCES ozon_scraper_users(id) ON DELETE CASCADE,
    name TEXT,
    group_type TEXT DEFAULT 'comparison',
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),

    CONSTRAINT valid_group_type CHECK (group_type IN ('comparison', 'variants', 'similar'))
);

-- 2. –¢–∞–±–ª–∏—Ü–∞ —á–ª–µ–Ω–æ–≤ –≥—Ä—É–ø–ø—ã (—Å–≤—è–∑—å –º–Ω–æ–≥–∏–µ-–∫–æ-–º–Ω–æ–≥–∏–º)
CREATE TABLE IF NOT EXISTS ozon_scraper_article_group_members (
    id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
    group_id UUID NOT NULL REFERENCES ozon_scraper_article_groups(id) ON DELETE CASCADE,
    article_id UUID NOT NULL REFERENCES ozon_scraper_articles(id) ON DELETE CASCADE,
    role TEXT DEFAULT 'item',
    position INTEGER DEFAULT 0,
    added_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),

    CONSTRAINT valid_role CHECK (role IN ('own', 'competitor', 'item')),
    CONSTRAINT unique_group_article UNIQUE (group_id, article_id)
);

-- 3. –¢–∞–±–ª–∏—Ü–∞ —Å–Ω—ç–ø—à–æ—Ç–æ–≤ —Å—Ä–∞–≤–Ω–µ–Ω–∏–π (–¥–ª—è –∏—Å—Ç–æ—Ä–∏–∏)
CREATE TABLE IF NOT EXISTS ozon_scraper_comparison_snapshots (
    id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
    group_id UUID NOT NULL REFERENCES ozon_scraper_article_groups(id) ON DELETE CASCADE,
    snapshot_date TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    comparison_data JSONB NOT NULL,
    metrics JSONB,
    competitiveness_index DECIMAL(3,2),
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- –ò–Ω–¥–µ–∫—Å—ã
CREATE INDEX idx_article_groups_user_id ON ozon_scraper_article_groups(user_id);
CREATE INDEX idx_article_groups_type ON ozon_scraper_article_groups(group_type);
CREATE INDEX idx_group_members_group_id ON ozon_scraper_article_group_members(group_id);
CREATE INDEX idx_group_members_article_id ON ozon_scraper_article_group_members(article_id);
CREATE INDEX idx_group_members_role ON ozon_scraper_article_group_members(role);
CREATE INDEX idx_comparison_snapshots_group_date ON ozon_scraper_comparison_snapshots(group_id, snapshot_date DESC);
CREATE INDEX idx_comparison_snapshots_metrics ON ozon_scraper_comparison_snapshots USING GIN(metrics);
CREATE INDEX idx_comparison_snapshots_index ON ozon_scraper_comparison_snapshots(competitiveness_index);

-- –¢—Ä–∏–≥–≥–µ—Ä—ã
CREATE TRIGGER update_article_groups_updated_at
    BEFORE UPDATE ON ozon_scraper_article_groups
    FOR EACH ROW
    EXECUTE FUNCTION update_updated_at_column();

-- RLS Policies
ALTER TABLE ozon_scraper_article_groups ENABLE ROW LEVEL SECURITY;
ALTER TABLE ozon_scraper_article_group_members ENABLE ROW LEVEL SECURITY;
ALTER TABLE ozon_scraper_comparison_snapshots ENABLE ROW LEVEL SECURITY;

CREATE POLICY "Users can view own groups"
    ON ozon_scraper_article_groups FOR SELECT
    USING (auth.uid()::text = user_id::text);

CREATE POLICY "Users can create own groups"
    ON ozon_scraper_article_groups FOR INSERT
    WITH CHECK (auth.uid()::text = user_id::text);

CREATE POLICY "Users can update own groups"
    ON ozon_scraper_article_groups FOR UPDATE
    USING (auth.uid()::text = user_id::text);

CREATE POLICY "Users can delete own groups"
    ON ozon_scraper_article_groups FOR DELETE
    USING (auth.uid()::text = user_id::text);

-- Grants
GRANT SELECT, INSERT, UPDATE, DELETE ON ozon_scraper_article_groups TO authenticated, service_role;
GRANT SELECT, INSERT, UPDATE, DELETE ON ozon_scraper_article_group_members TO authenticated, service_role;
GRANT SELECT, INSERT ON ozon_scraper_comparison_snapshots TO authenticated, service_role;

-- SQL –§—É–Ω–∫—Ü–∏–∏
CREATE OR REPLACE FUNCTION get_group_comparison(p_group_id UUID)
RETURNS TABLE (
    article_id UUID,
    article_number TEXT,
    role TEXT,
    current_price DECIMAL(10,2),
    current_rating DECIMAL(3,2),
    spp_total DECIMAL(5,2)
) AS $$
BEGIN
    RETURN QUERY
    SELECT
        a.id,
        a.article_number,
        m.role,
        a.price,
        a.rating,
        a.spp_total
    FROM ozon_scraper_article_group_members m
    JOIN ozon_scraper_articles a ON m.article_id = a.id
    WHERE m.group_id = p_group_id
    ORDER BY m.position, m.added_at;
END;
$$ LANGUAGE plpgsql;

CREATE OR REPLACE FUNCTION save_comparison_snapshot(
    p_group_id UUID,
    p_comparison_data JSONB,
    p_metrics JSONB,
    p_competitiveness_index DECIMAL(3,2)
)
RETURNS UUID AS $$
DECLARE
    v_snapshot_id UUID;
BEGIN
    INSERT INTO ozon_scraper_comparison_snapshots (
        group_id,
        comparison_data,
        metrics,
        competitiveness_index
    ) VALUES (
        p_group_id,
        p_comparison_data,
        p_metrics,
        p_competitiveness_index
    ) RETURNING id INTO v_snapshot_id;

    RETURN v_snapshot_id;
END;
$$ LANGUAGE plpgsql;

COMMIT;
```

---

## üìã –§–ê–ó–ê 2: Backend Models & Service (–î–µ–Ω—å 2)

### –ó–∞–¥–∞—á–∏:

- [ ] **2.1. –°–æ–∑–¥–∞—Ç—å `backend/models/comparison.py`:**
  - `ArticleRole` (Enum: own, competitor, item)
  - `GroupType` (Enum: comparison, variants, similar)
  - `ArticleGroupMemberCreate` - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∞—Ä—Ç–∏–∫—É–ª–∞ –≤ –≥—Ä—É–ø–ø—É
  - `ArticleGroupCreate` - —Å–æ–∑–¥–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã
  - `ArticleGroupMemberResponse` - —á–ª–µ–Ω –≥—Ä—É–ø–ø—ã
  - `ArticleGroupResponse` - –≥—Ä—É–ø–ø–∞ –∞—Ä—Ç–∏–∫—É–ª–æ–≤
  - `PriceDifference` - —Ä–∞–∑–Ω–∏—Ü–∞ –≤ —Ü–µ–Ω–∞—Ö
  - `RatingDifference` - —Ä–∞–∑–Ω–∏—Ü–∞ –≤ —Ä–µ–π—Ç–∏–Ω–≥–∞—Ö
  - `SPPDifference` - —Ä–∞–∑–Ω–∏—Ü–∞ –≤ –°–ü–ü
  - `ComparisonMetrics` - –≤—Å–µ –º–µ—Ç—Ä–∏–∫–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
  - `ArticleComparisonData` - –¥–∞–Ω–Ω—ã–µ –∞—Ä—Ç–∏–∫—É–ª–∞ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
  - `ComparisonResponse` - –ø–æ–ª–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ
  - `ComparisonSnapshotResponse` - —Å–Ω—ç–ø—à–æ—Ç –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏

- [ ] **2.2. –°–æ–∑–¥–∞—Ç—å `backend/services/comparison_service.py`:**
  - `ComparisonService` class
  - `create_comparison_group()` - —Å–æ–∑–¥–∞—Ç—å –≥—Ä—É–ø–ø—É + scrape –æ–±–∞ –∞—Ä—Ç–∏–∫—É–ª–∞
  - `get_comparison()` - –ø–æ–ª—É—á–∏—Ç—å —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏
  - `refresh_comparison()` - –æ–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ (re-scrape)
  - `get_comparison_history()` - –∏—Å—Ç–æ—Ä–∏—è —Å–Ω—ç–ø—à–æ—Ç–æ–≤
  - `delete_group()` - —É–¥–∞–ª–∏—Ç—å –≥—Ä—É–ø–ø—É
  - `_calculate_comparison_metrics()` - —Ä–∞—Å—á–µ—Ç –≤—Å–µ—Ö –º–µ—Ç—Ä–∏–∫
  - `_calculate_competitiveness_index()` - –∏–Ω–¥–µ–∫—Å 0-1 (–≤–∑–≤–µ—à–µ–Ω–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞)
  - `_get_grade()` - –≥—Ä–µ–π–¥—ã A-F
  - `_generate_recommendations()` - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
  - `_save_snapshot()` - —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–Ω—ç–ø—à–æ—Ç
  - `_get_or_create_article()` - –ø–æ–ª—É—á–∏—Ç—å/—Å–æ–∑–¥–∞—Ç—å –∞—Ä—Ç–∏–∫—É–ª

### –ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏:

**–†–∞–∑–Ω–∏—Ü–∞ –≤ —Ü–µ–Ω–∞—Ö:**
```python
PriceDifference:
  - absolute: float (—Ä–∞–∑–Ω–∏—Ü–∞ –≤ —Ä—É–±–ª—è—Ö)
  - percentage: float (—Ä–∞–∑–Ω–∏—Ü–∞ –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö)
  - who_cheaper: str ('own' –∏–ª–∏ 'competitor')
  - recommendation: str (–Ω–∞–ø—Ä–∏–º–µ—Ä: "–°–Ω–∏–∑—å—Ç–µ —Ü–µ–Ω—É –Ω–∞ 5-7%")
```

**–ò–Ω–¥–µ–∫—Å –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ (0-1):**
```python
# –í–∑–≤–µ—à–µ–Ω–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞:
weights = {
    'price': 0.35,      # 35% - —Ü–µ–Ω–∞
    'rating': 0.25,     # 25% - —Ä–µ–π—Ç–∏–Ω–≥
    'spp': 0.20,        # 20% - –°–ü–ü
    'reviews': 0.10,    # 10% - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–∑—ã–≤–æ–≤
    'availability': 0.10 # 10% - –Ω–∞–ª–∏—á–∏–µ —Ç–æ–≤–∞—Ä–∞
}

# –ì—Ä–µ–π–¥—ã:
A: 0.85-1.00  (–û—Ç–ª–∏—á–Ω–∞—è –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å)
B: 0.70-0.84  (–•–æ—Ä–æ—à–∞—è –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å)
C: 0.50-0.69  (–°—Ä–µ–¥–Ω—è—è –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å)
D: 0.30-0.49  (–ù–∏–∑–∫–∞—è –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å)
F: 0.00-0.29  (–û—á–µ–Ω—å –Ω–∏–∑–∫–∞—è –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å)
```

---

## üìã –§–ê–ó–ê 3: Backend API (–î–µ–Ω—å 2-3)

### –ó–∞–¥–∞—á–∏:

- [ ] **3.1. –°–æ–∑–¥–∞—Ç—å `backend/routers/comparisons.py`:**
  - `POST /api/v1/article-groups` - —Å–æ–∑–¥–∞—Ç—å –≥—Ä—É–ø–ø—É —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
  - `GET /api/v1/article-groups` - —Å–ø–∏—Å–æ–∫ –≥—Ä—É–ø–ø –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Å —Ñ–∏–ª—å—Ç—Ä–æ–º –ø–æ —Ç–∏–ø—É)
  - `GET /api/v1/article-groups/{id}` - –¥–µ—Ç–∞–ª–∏ –≥—Ä—É–ø–ø—ã
  - `GET /api/v1/article-groups/{id}/comparison` - —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏
  - `POST /api/v1/article-groups/{id}/refresh` - –æ–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ (re-scrape)
  - `GET /api/v1/article-groups/{id}/history` - –∏—Å—Ç–æ—Ä–∏—è —Å–Ω—ç–ø—à–æ—Ç–æ–≤ –∑–∞ N –¥–Ω–µ–π
  - `DELETE /api/v1/article-groups/{id}` - —É–¥–∞–ª–∏—Ç—å –≥—Ä—É–ø–ø—É
  - `POST /api/v1/article-groups/{id}/members` - –¥–æ–±–∞–≤–∏—Ç—å –∞—Ä—Ç–∏–∫—É–ª –≤ –≥—Ä—É–ø–ø—É
  - `DELETE /api/v1/article-groups/{id}/members/{article_id}` - —É–¥–∞–ª–∏—Ç—å –∞—Ä—Ç–∏–∫—É–ª –∏–∑ –≥—Ä—É–ø–ø—ã

- [ ] **3.2. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å router –≤ `backend/main.py`:**
  ```python
  from routers import comparisons

  app.include_router(
      comparisons.router,
      prefix="/api/v1",
      tags=["comparisons"]
  )
  ```

- [ ] **3.3. –ò—Å–ø—Ä–∞–≤–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –æ—à–∏–±–∫—É `average_price_7days = None`:**
  - –í `backend/routers/articles.py` (create_article endpoint)
  - –î–æ–±–∞–≤–∏—Ç—å fallback: –µ—Å–ª–∏ `average_price_7days` None ‚Üí –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `normal_price`
  - –≠—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç –°–ü–ü —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—Ç—å—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –¥–∞–∂–µ –¥–ª—è –Ω–æ–≤—ã—Ö –∞—Ä—Ç–∏–∫—É–ª–æ–≤

### API Schemas (–ø—Ä–∏–º–µ—Ä—ã):

**POST /api/v1/article-groups - Request:**
```json
{
  "user_id": "uuid",
  "name": "–ú–æ–π —Ç–æ–≤–∞—Ä vs –ö–æ–Ω–∫—É—Ä–µ–Ω—Ç",
  "group_type": "comparison",
  "articles": [
    {"article_number": "123456789", "role": "own"},
    {"article_number": "987654321", "role": "competitor"}
  ]
}
```

**GET /api/v1/article-groups/{id}/comparison - Response:**
```json
{
  "group_id": "uuid",
  "group_name": "–ú–æ–π —Ç–æ–≤–∞—Ä vs –ö–æ–Ω–∫—É—Ä–µ–Ω—Ç",
  "compared_at": "2025-10-29T12:00:00Z",
  "articles": [
    {
      "article_id": "uuid",
      "article_number": "123456789",
      "role": "own",
      "name": "–¢–æ–≤–∞—Ä –Ω–∞–∑–≤–∞–Ω–∏–µ",
      "price": 1999.00,
      "ozon_card_price": 1799.00,
      "rating": 4.5,
      "reviews_count": 120,
      "spp_total": 15.2
    },
    {
      "article_id": "uuid",
      "article_number": "987654321",
      "role": "competitor",
      "name": "–ö–æ–Ω–∫—É—Ä–µ–Ω—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ",
      "price": 1899.00,
      "ozon_card_price": 1699.00,
      "rating": 4.7,
      "reviews_count": 200,
      "spp_total": 18.1
    }
  ],
  "metrics": {
    "price_difference": {
      "absolute": 100.00,
      "percentage": 5.9,
      "who_cheaper": "competitor",
      "recommendation": "–í–∞—à–∞ —Ü–µ–Ω–∞ –≤—ã—à–µ –Ω–∞ 5.9%. –†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ —Å–Ω–∏–∂–µ–Ω–∏–µ."
    },
    "rating_difference": {
      "absolute": -0.2,
      "percentage": -4.3,
      "who_better": "competitor"
    },
    "spp_difference": {
      "spp_total": -2.9,
      "who_better": "competitor"
    },
    "competitiveness_index": 0.72,
    "competitiveness_grade": "C",
    "recommendations": [
      "–°–Ω–∏–∑—å—Ç–µ —Ü–µ–Ω—É –Ω–∞ 5-7% –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏",
      "–í–∞—à —Ä–µ–π—Ç–∏–Ω–≥ –Ω–∏–∂–µ - —Ä–∞–±–æ—Ç–∞–π—Ç–µ –Ω–∞–¥ –∫–∞—á–µ—Å—Ç–≤–æ–º —Ç–æ–≤–∞—Ä–∞/—Å–µ—Ä–≤–∏—Å–∞",
      "–£–≤–µ–ª–∏—á—å—Ç–µ –°–ü–ü –¥–æ —É—Ä–æ–≤–Ω—è –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–∞"
    ]
  }
}
```

---

## üìã –§–ê–ó–ê 4: Bot Integration (–î–µ–Ω—å 3-4)

### –ó–∞–¥–∞—á–∏:

- [ ] **4.1. –°–æ–∑–¥–∞—Ç—å `bot/handlers/comparisons.py`:**
  - FSM States: `waiting_for_own_article`, `waiting_for_competitor_article`
  - `cmd_compare()` - –∫–æ–º–∞–Ω–¥–∞ /compare
  - `process_own_article()` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–≤–æ–µ–≥–æ –∞—Ä—Ç–∏–∫—É–ª–∞
  - `process_competitor_article()` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–∞ + —Å–æ–∑–¥–∞–Ω–∏–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
  - `cmd_list_comparisons()` - —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Å—Ä–∞–≤–Ω–µ–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  - `callback_refresh_comparison()` - –æ–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ (callback –∫–Ω–æ–ø–∫–∏)
  - `callback_show_history()` - –ø–æ–∫–∞–∑–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—é —Å—Ä–∞–≤–Ω–µ–Ω–∏–π
  - `callback_delete_comparison()` - —É–¥–∞–ª–∏—Ç—å –≥—Ä—É–ø–ø—É (—Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º)

- [ ] **4.2. –°–æ–∑–¥–∞—Ç—å `bot/utils/formatters.py` –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ:**
  - `format_comparison(comparison: Dict) -> str` - –∫—Ä–∞—Å–∏–≤—ã–π –≤—ã–≤–æ–¥ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
  - `format_comparison_list(comparisons: List[Dict]) -> str` - —Å–ø–∏—Å–æ–∫ —Å—Ä–∞–≤–Ω–µ–Ω–∏–π
  - `format_comparison_history(history: List[Dict]) -> str` - –∏—Å—Ç–æ—Ä–∏—è

- [ ] **4.3. –û–±–Ω–æ–≤–∏—Ç—å `bot/keyboards.py`:**
  - `get_comparison_keyboard(group_id: str)` - –∫–Ω–æ–ø–∫–∏ [üîÑ –û–±–Ω–æ–≤–∏—Ç—å] [üìä –ò—Å—Ç–æ—Ä–∏—è] [üóë –£–¥–∞–ª–∏—Ç—å]
  - `get_comparison_list_keyboard(comparisons: List[Dict])` - inline –∫–Ω–æ–ø–∫–∏ –¥–ª—è —Å–ø–∏—Å–∫–∞
  - –î–æ–±–∞–≤–∏—Ç—å "üìä –°—Ä–∞–≤–Ω–µ–Ω–∏—è" –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é `get_main_menu()`

- [ ] **4.4. –û–±–Ω–æ–≤–∏—Ç—å `bot/services/api_client.py`:**
  - `create_comparison_group(user_id, own_article, competitor_article)` ‚Üí ArticleGroupResponse
  - `get_user_comparisons(user_id)` ‚Üí List[ArticleGroupResponse]
  - `get_comparison(group_id, refresh=False)` ‚Üí ComparisonResponse
  - `refresh_comparison(group_id)` ‚Üí ComparisonResponse
  - `get_comparison_history(group_id, days=30)` ‚Üí List[ComparisonSnapshotResponse]
  - `delete_comparison_group(group_id)` ‚Üí success/error

- [ ] **4.5. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å router –≤ `bot/main.py`:**
  ```python
  from handlers import comparisons

  dp.include_router(comparisons.router)
  ```

### Bot Flow (–¥–µ—Ç–∞–ª—å–Ω—ã–π):

```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: /compare
   ‚Üì
   –ë–æ—Ç: "‚ûï –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è

         –û—Ç–ø—Ä–∞–≤—å—Ç–µ –°–í–û–ô –∞—Ä—Ç–∏–∫—É–ª (–∫–æ—Ç–æ—Ä—ã–π –≤—ã –ø—Ä–æ–¥–∞—ë—Ç–µ):
         üìù –ü—Ä–∏–º–µ—Ä: 123456789

         ‚ùå –û—Ç–º–µ–Ω–∞"

2. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: 123456789
   ‚Üì
   –í–∞–ª–∏–¥–∞—Ü–∏—è –∞—Ä—Ç–∏–∫—É–ª–∞ (5-12 —Ü–∏—Ñ—Ä)
   ‚Üì
   FSM State: waiting_for_competitor_article
   ‚Üì
   –ë–æ—Ç: "‚úÖ –í–∞—à –∞—Ä—Ç–∏–∫—É–ª: 123456789

         –¢–µ–ø–µ—Ä—å –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –∞—Ä—Ç–∏–∫—É–ª –ö–û–ù–ö–£–†–ï–ù–¢–ê:
         üìù –ü—Ä–∏–º–µ—Ä: 987654321

         ‚ùå –û—Ç–º–µ–Ω–∞"

3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: 987654321
   ‚Üì
   –í–∞–ª–∏–¥–∞—Ü–∏—è –∞—Ä—Ç–∏–∫—É–ª–∞
   ‚Üì
   API: create_comparison_group(user_id, 123456789, 987654321)
   ‚Üì
   Scraping –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±–æ–∏—Ö –∞—Ä—Ç–∏–∫—É–ª–æ–≤ (~10-15 —Å–µ–∫)
   ‚Üì
   –†–∞—Å—á—ë—Ç –º–µ—Ç—Ä–∏–∫ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
   ‚Üì
   FSM State: clear
   ‚Üì
   –ë–æ—Ç: [–§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏]

        üìä –°–†–ê–í–ù–ï–ù–ò–ï –ê–†–¢–ò–ö–£–õ–û–í

        üü¢ –í–ê–® –¢–û–í–ê–†: 123456789
        ‚îú‚îÄ –ù–∞–∑–≤–∞–Ω–∏–µ: –¢–æ–≤–∞—Ä...
        ‚îú‚îÄ –¶–µ–Ω–∞: 1999 ‚ÇΩ
        ‚îú‚îÄ –° Ozon Card: 1799 ‚ÇΩ
        ‚îú‚îÄ –†–µ–π—Ç–∏–Ω–≥: 4.5 ‚≠ê
        ‚îî‚îÄ –°–ü–ü: 15.2%

        üî¥ –ö–û–ù–ö–£–†–ï–ù–¢: 987654321
        ‚îú‚îÄ –ù–∞–∑–≤–∞–Ω–∏–µ: –ö–æ–Ω–∫—É—Ä–µ–Ω—Ç...
        ‚îú‚îÄ –¶–µ–Ω–∞: 1899 ‚ÇΩ
        ‚îú‚îÄ –° Ozon Card: 1699 ‚ÇΩ
        ‚îú‚îÄ –†–µ–π—Ç–∏–Ω–≥: 4.7 ‚≠ê
        ‚îî‚îÄ –°–ü–ü: 18.1%

        üìà –†–ê–ó–ù–ò–¶–ê:
        ‚ùå –í–∞—à–∞ —Ü–µ–Ω–∞ –≤—ã—à–µ –Ω–∞ 100‚ÇΩ (5.9%)
        ‚ùå –í–∞—à —Ä–µ–π—Ç–∏–Ω–≥ –Ω–∏–∂–µ –Ω–∞ -0.2
        ‚ùå –í–∞—à –°–ü–ü –Ω–∏–∂–µ –Ω–∞ -2.9%

        üéØ –ò–ù–î–ï–ö–° –ö–û–ù–ö–£–†–ï–ù–¢–û–°–ü–û–°–û–ë–ù–û–°–¢–ò:
        ‚ö° 0.72 (–ì—Ä–µ–π–¥: C - –°—Ä–µ–¥–Ω—è—è –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å)

        üí° –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò:
        ‚Ä¢ –°–Ω–∏–∑—å—Ç–µ —Ü–µ–Ω—É –Ω–∞ 5-7%
        ‚Ä¢ –†–∞–±–æ—Ç–∞–π—Ç–µ –Ω–∞–¥ —Ä–µ–π—Ç–∏–Ω–≥–æ–º
        ‚Ä¢ –£–≤–µ–ª–∏—á—å—Ç–µ –°–ü–ü

        [üîÑ –û–±–Ω–æ–≤–∏—Ç—å] [üìä –ò—Å—Ç–æ—Ä–∏—è] [üóë –£–¥–∞–ª–∏—Ç—å]
```

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏:**
- –ï—Å–ª–∏ –∞—Ä—Ç–∏–∫—É–ª –Ω–µ –Ω–∞–π–¥–µ–Ω –Ω–∞ OZON ‚Üí "‚ùå –¢–æ–≤–∞—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∞—Ä—Ç–∏–∫—É–ª"
- –ï—Å–ª–∏ –ø–∞—Ä–∞ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç ‚Üí "‚ö†Ô∏è –¢–∞–∫–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —É–∂–µ –µ—Å—Ç—å. [–û—Ç–∫—Ä—ã—Ç—å]"
- –ï—Å–ª–∏ –ª–∏–º–∏—Ç –≥—Ä—É–ø–ø –¥–æ—Å—Ç–∏–≥–Ω—É—Ç (10) ‚Üí "‚ùå –î–æ—Å—Ç–∏–≥–Ω—É—Ç –ª–∏–º–∏—Ç. –£–¥–∞–ª–∏—Ç–µ —Å—Ç–∞—Ä—ã–µ"
- –ï—Å–ª–∏ scraping –Ω–µ —É–¥–∞–ª—Å—è ‚Üí "‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ"

---

## üìã –§–ê–ó–ê 5: Cron Job –¥–ª—è –∏—Å—Ç–æ—Ä–∏–∏ (–î–µ–Ω—å 5)

### –ó–∞–¥–∞—á–∏:

- [ ] **5.1. –û–±–Ω–æ–≤–∏—Ç—å `backend/services/scheduler.py`:**
  - –î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞—á—É `update_comparison_snapshots()`
  - –î–ª—è –∫–∞–∂–¥–æ–π –∞–∫—Ç–∏–≤–Ω–æ–π –≥—Ä—É–ø–ø—ã:
    1. –ü–æ–ª—É—á–∏—Ç—å –∞—Ä—Ç–∏–∫—É–ª—ã –≥—Ä—É–ø–ø—ã
    2. Scrape –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∞—Ä—Ç–∏–∫—É–ª–∞
    3. –†–∞—Å—Å—á–∏—Ç–∞—Ç—å –º–µ—Ç—Ä–∏–∫–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
    4. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–Ω—ç–ø—à–æ—Ç –≤ `comparison_snapshots`
  - –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ: –∫–∞–∂–¥—ã–µ 24 —á–∞—Å–∞ (–∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ `price_history_collector`)
  - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Å–ø–µ—Ö–æ–≤/–æ—à–∏–±–æ–∫

- [ ] **5.2. –û–±–Ω–æ–≤–∏—Ç—å `backend/main.py`:**
  - –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—É—é cron –∑–∞–¥–∞—á—É –ø—Ä–∏ startup

### –ü—Å–µ–≤–¥–æ–∫–æ–¥ Cron Job:

```python
async def update_comparison_snapshots():
    """
    –û–±–Ω–æ–≤–∏—Ç—å —Å–Ω—ç–ø—à–æ—Ç—ã –¥–ª—è –≤—Å–µ—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö –≥—Ä—É–ø–ø —Å—Ä–∞–≤–Ω–µ–Ω–∏—è

    –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∫–∞–∂–¥—ã–µ 24 —á–∞—Å–∞ —á–µ—Ä–µ–∑ scheduler
    """
    logger.info("Starting comparison snapshots update...")

    supabase = get_supabase_client()
    comparison_service = ComparisonService()

    # –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –≥—Ä—É–ø–ø—ã
    groups = supabase.table("ozon_scraper_article_groups")\
        .select("*")\
        .execute()

    total = len(groups.data)
    success = 0
    errors = 0

    for group in groups.data:
        try:
            # –û–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∏ –ø–æ–ª—É—á–∏—Ç—å —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ
            comparison = await comparison_service.get_comparison(
                group_id=group["id"],
                refresh=True  # Re-scrape
            )

            # –°–Ω—ç–ø—à–æ—Ç —É–∂–µ —Å–æ—Ö—Ä–∞–Ω—ë–Ω –≤–Ω—É—Ç—Ä–∏ get_comparison
            success += 1
            logger.info(f"Snapshot saved for group {group['id']}")

        except Exception as e:
            errors += 1
            logger.error(f"Error for group {group['id']}: {e}")

    logger.success(f"Comparison snapshots updated: {success}/{total} (errors: {errors})")
```

### –ü–æ–ª—å–∑–∞ —Å–Ω—ç–ø—à–æ—Ç–æ–≤:

- **–ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π:** "–ù–µ–¥–µ–ª—é –Ω–∞–∑–∞–¥ –≤–∞—à–∞ —Ü–µ–Ω–∞ –±—ã–ª–∞ –≤—ã–≥–æ–¥–Ω–µ–µ"
- **–ì—Ä–∞—Ñ–∏–∫–∏:** –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏–Ω–¥–µ–∫—Å–∞ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
- **–¢—Ä–µ–Ω–¥—ã:** "–ö–æ–Ω–∫—É—Ä–µ–Ω—Ç –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ —Å–Ω–∏–∂–∞–µ—Ç —Ü–µ–Ω—ã –ø–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π"
- **–ê–Ω–∞–ª–∏—Ç–∏–∫–∞:** –ö–∞–∫–∏–µ —Ñ–∞–∫—Ç–æ—Ä—ã –≤–ª–∏—è–ª–∏ –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏
- **–ê–ª–µ—Ä—Ç—ã:** "–ö–æ–Ω–∫—É—Ä–µ–Ω—Ç —Å–Ω–∏–∑–∏–ª —Ü–µ–Ω—É –Ω–∞ 10% - –ø–æ—Ä–∞ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å!"

---

## üìã –§–ê–ó–ê 6: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (–î–µ–Ω—å 6)

### –ó–∞–¥–∞—á–∏:

- [ ] **6.1. Backend unit —Ç–µ—Å—Ç—ã:**
  - `test_create_comparison_group()` - —Å–æ–∑–¥–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã
  - `test_calculate_comparison_metrics()` - —Ä–∞—Å—á–µ—Ç –º–µ—Ç—Ä–∏–∫
  - `test_competitiveness_index()` - –∏–Ω–¥–µ–∫—Å –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
  - `test_save_snapshot()` - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–Ω—ç–ø—à–æ—Ç–∞
  - `test_get_comparison_history()` - –ø–æ–ª—É—á–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏
  - `test_delete_group()` - —É–¥–∞–ª–µ–Ω–∏–µ –≥—Ä—É–ø–ø—ã

- [ ] **6.2. API integration —Ç–µ—Å—Ç—ã:**
  - –ü–æ–ª–Ω—ã–π flow: —Å–æ–∑–¥–∞–Ω–∏–µ ‚Üí –ø–æ–ª—É—á–µ–Ω–∏–µ ‚Üí –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ ‚Üí —É–¥–∞–ª–µ–Ω–∏–µ
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–µ—Ç—Ä–∏–∫ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
  - –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ (–Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∞—Ä—Ç–∏–∫—É–ª—ã, –ª–∏–º–∏—Ç—ã)

- [ ] **6.3. Bot integration —Ç–µ—Å—Ç—ã:**
  - –ü–æ–ª–Ω—ã–π flow —á–µ—Ä–µ–∑ FSM
  - –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥ /compare, /comparisons
  - Callback buttons (–æ–±–Ω–æ–≤–∏—Ç—å, –∏—Å—Ç–æ—Ä–∏—è, —É–¥–∞–ª–∏—Ç—å)

- [ ] **6.4. Manual —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
  - –†–µ–∞–ª—å–Ω—ã–µ –∞—Ä—Ç–∏–∫—É–ª—ã OZON
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π
  - UI/UX –±–æ—Ç–∞ (—á–∏—Ç–∞–µ–º–æ—Å—Ç—å, —É–¥–æ–±—Å—Ç–≤–æ)
  - Edge cases (–Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã, –±–æ–ª—å—à–∏–µ —Ä–∞–∑–Ω–∏—Ü—ã –≤ —Ü–µ–Ω–∞—Ö)

- [ ] **6.5. Performance —Ç–µ—Å—Ç—ã:**
  - –í—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å <20 —Å–µ–∫)
  - –ù–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ –ë–î –ø—Ä–∏ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –≥—Ä—É–ø–ø
  - Cron job –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

---

## üìã –§–ê–ó–ê 7: Deployment (–î–µ–Ω—å 7)

### –ó–∞–¥–∞—á–∏:

- [ ] **7.1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –¥–µ–ø–ª–æ—é:**
  - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –≤ dev –æ–∫—Ä—É–∂–µ–Ω–∏–∏
  - Code review –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π
  - –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é (README, API docs)

- [ ] **7.2. –î–µ–ø–ª–æ–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä:**
  ```bash
  # 1. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –≤ Supabase production
  # (—á–µ—Ä–µ–∑ Supabase Dashboard –∏–ª–∏ SQL Editor)

  # 2. –ü–æ–¥—Ç—è–Ω—É—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
  git pull origin main

  # 3. –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å backend
  docker-compose -f docker-compose.prod.yml build backend

  # 4. –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å bot
  docker-compose -f docker-compose.prod.yml build bot

  # 5. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã
  docker-compose -f docker-compose.prod.yml up -d

  # 6. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
  docker-compose -f docker-compose.prod.yml logs -f backend bot
  ```

- [ ] **7.3. Post-deployment –ø—Ä–æ–≤–µ—Ä–∫–∏:**
  - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —á–µ—Ä–µ–∑ –±–æ—Ç–∞
  - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ API endpoints (—á–µ—Ä–µ–∑ /docs)
  - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É Cron job (–≤ –ª–æ–≥–∞—Ö —á–µ—Ä–µ–∑ 24 —á–∞—Å–∞)
  - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ—à–∏–±–æ–∫ –ø–µ—Ä–≤—ã–µ 48 —á–∞—Å–æ–≤

- [ ] **7.4. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
  - –û–±–Ω–æ–≤–∏—Ç—å README.md —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –Ω–æ–≤–æ–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ
  - –û–±–Ω–æ–≤–∏—Ç—å API documentation
  - –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

---

## üéØ –ü–†–ò–û–†–ò–¢–ï–¢–´ –ò –û–¶–ï–ù–ö–ò

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ (MVP):

| –ó–∞–¥–∞—á–∞ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –í—Ä–µ–º—è | –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ |
|--------|-----------|-------|-------------|
| –ú–∏–≥—Ä–∞—Ü–∏—è –ë–î | P0 | 2—á | - |
| Backend models (comparison.py) | P0 | 3—á | –ú–∏–≥—Ä–∞—Ü–∏—è |
| ComparisonService | P0 | 6—á | Models |
| API endpoints | P0 | 4—á | Service |
| Bot FSM flow (/compare) | P0 | 4—á | API |
| –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –±–æ—Ç–µ | P0 | 2—á | Bot flow |

**–ò—Ç–æ–≥–æ MVP: ~21 —á–∞—Å (3 –¥–Ω—è)**

### –í–∞–∂–Ω–æ (Phase 2):

| –ó–∞–¥–∞—á–∞ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –í—Ä–µ–º—è | –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ |
|--------|-----------|-------|-------------|
| –°–ø–∏—Å–æ–∫ —Å—Ä–∞–≤–Ω–µ–Ω–∏–π (/comparisons) | P1 | 2—á | MVP |
| –ö–Ω–æ–ø–∫–∞ "–û–±–Ω–æ–≤–∏—Ç—å" | P1 | 1—á | MVP |
| –ò—Å—Ç–æ—Ä–∏—è —Å—Ä–∞–≤–Ω–µ–Ω–∏–π | P1 | 3—á | Snapshots |
| Cron job snapshots | P1 | 4—á | Service |
| –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ | P1 | 6—á | –í—Å—ë |

**–ò—Ç–æ–≥–æ Phase 2: ~16 —á–∞—Å–æ–≤ (2 –¥–Ω—è)**

### Nice to have (Future):

- –ì—Ä–∞—Ñ–∏–∫–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π (Chart.js –∏–ª–∏ matplotlib)
- –≠–∫—Å–ø–æ—Ä—Ç –≤ CSV/PDF
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ 3+ –∞—Ä—Ç–∏–∫—É–ª–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
- –ê–ª–µ—Ä—Ç—ã "–∫–æ–Ω–∫—É—Ä–µ–Ω—Ç —Å–Ω–∏–∑–∏–ª —Ü–µ–Ω—É!"
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π —Ü–µ–Ω–µ
- –ê–Ω–∞–ª–∏–∑ —Ç—Ä–µ–Ω–¥–æ–≤ (ML predictions)

---

## ‚ö†Ô∏è –í–ê–ñ–ù–´–ï –ó–ê–ú–ï–ß–ê–ù–ò–Ø

### –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:
- ‚úÖ –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∞—Ä—Ç–∏–∫—É–ª—ã (–±–µ–∑ –≥—Ä—É–ø–ø) –ø—Ä–æ–¥–æ–ª–∂–∞—Ç —Ä–∞–±–æ—Ç–∞—Ç—å
- ‚úÖ –°—Ç–∞—Ä—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª `/add`, `/list` –Ω–µ –∑–∞—Ç—Ä–∞–≥–∏–≤–∞–µ—Ç—Å—è
- ‚úÖ –ù–æ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã –æ—Ç —Å—Ç–∞—Ä—ã—Ö

### –ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö:
- ‚ùå **–ù–ï —Ç—Ä–µ–±—É–µ—Ç—Å—è** - –Ω–æ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã —Å–æ–∑–¥–∞—é—Ç—Å—è –ø—É—Å—Ç—ã–º–∏
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–∞—á–Ω—É—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –≥—Ä—É–ø–ø—ã —Å –Ω—É–ª—è

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:
- Scraping 2 –∞—Ä—Ç–∏–∫—É–ª–æ–≤: **~10-15 —Å–µ–∫—É–Ω–¥**
- –†–∞—Å—á–µ—Ç –º–µ—Ç—Ä–∏–∫: **<1 —Å–µ–∫—É–Ω–¥—ã**
- Cron job –¥–ª—è 100 –≥—Ä—É–ø–ø: **~30 –º–∏–Ω—É—Ç**

### –õ–∏–º–∏—Ç—ã:
- **10 –≥—Ä—É–ø–ø** –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ —Å–ø–∞–º–∞)
- **5 –∞—Ä—Ç–∏–∫—É–ª–æ–≤** –≤ –æ–¥–Ω–æ–π –≥—Ä—É–ø–ø–µ (–¥–ª—è –±—É–¥—É—â–µ–≥–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è)
- –°–Ω—ç–ø—à–æ—Ç—ã —Ö—Ä–∞–Ω—è—Ç—Å—è **90 –¥–Ω–µ–π** (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞)

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:
- **RLS policies:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥—è—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –≥—Ä—É–ø–ø—ã
- **Rate limiting:** –°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã - 5 —Ä–∞–∑/–º–∏–Ω—É—Ç—É
- **–í–∞–ª–∏–¥–∞—Ü–∏—è:** –ü—Ä–æ–≤–µ—Ä–∫–∞ ownership –∞—Ä—Ç–∏–∫—É–ª–æ–≤

### Monitoring:
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —Å –≥—Ä—É–ø–ø–∞–º–∏
- –ú–µ—Ç—Ä–∏–∫–∏: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥—Ä—É–ø–ø, —á–∞—Å—Ç–æ—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
- –ê–ª–µ—Ä—Ç—ã –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö scraping

---

## üìä –ò–¢–û–ì–û–í–ê–Ø –û–¶–ï–ù–ö–ê

### –°—Ä–æ–∫–∏:
- **MVP (–º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª):** 3 –¥–Ω—è
- **Full Feature (—Å–æ –≤—Å–µ–º–∏ —É–ª—É—á—à–µ–Ω–∏—è–º–∏):** 7 –¥–Ω–µ–π
- **Deployment & Testing:** +1 –¥–µ–Ω—å

**–ò—Ç–æ–≥–æ: 7-8 –¥–Ω–µ–π** –ø–æ–ª–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### –§–∞–π–ª—ã:

**–ù–æ–≤—ã–µ (5 —Ñ–∞–π–ª–æ–≤):**
- `backend/migrations/008_article_comparison.sql`
- `backend/models/comparison.py`
- `backend/services/comparison_service.py`
- `backend/routers/comparisons.py`
- `bot/handlers/comparisons.py`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è (6 —Ñ–∞–π–ª–æ–≤):**
- `backend/main.py` (—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è router)
- `backend/services/scheduler.py` (cron job)
- `bot/main.py` (—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è handler)
- `bot/services/api_client.py` (–Ω–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã)
- `bot/utils/formatters.py` (format_comparison)
- `bot/keyboards.py` (–Ω–æ–≤—ã–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã)

### –†–µ–∑—É–ª—å—Ç–∞—Ç:

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–º–æ–∂–µ—Ç:
- ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –ø–∞—Ä—É –∞—Ä—Ç–∏–∫—É–ª–æ–≤ (—Å–≤–æ–π + –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç)
- ‚úÖ –£–≤–∏–¥–µ—Ç—å –¥–µ—Ç–∞–ª—å–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ –≤—Å–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º
- ‚úÖ –ü–æ–ª—É—á–∏—Ç—å **–ò–Ω–¥–µ–∫—Å –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏** –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
- ‚úÖ –°–ª–µ–¥–∏—Ç—å –∑–∞ –∏—Å—Ç–æ—Ä–∏–µ–π –∏–∑–º–µ–Ω–µ–Ω–∏–π (—á–µ—Ä–µ–∑ —Å–Ω—ç–ø—à–æ—Ç—ã)
- ‚úÖ –ü–æ–Ω–∏–º–∞—Ç—å —Å–≤–æ—é –ø–æ–∑–∏—Ü–∏—é –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–∞
- ‚úÖ –ü—Ä–∏–Ω–∏–º–∞—Ç—å —Ä–µ—à–µ–Ω–∏—è –æ —Ü–µ–Ω–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö

---

## üöÄ –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò

### –ß—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É:

1. **–°–æ–∑–¥–∞—Ç—å feature branch:**
   ```bash
   git checkout -b feature/article-comparison
   ```

2. **–ù–∞—á–∞—Ç—å —Å –§–∞–∑—ã 1 (–º–∏–≥—Ä–∞—Ü–∏—è –ë–î):**
   - –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª –º–∏–≥—Ä–∞—Ü–∏–∏
   - –ü—Ä–∏–º–µ–Ω–∏—Ç—å –≤ dev –æ–∫—Ä—É–∂–µ–Ω–∏–∏
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–∞–±–ª–∏—Ü

3. **–ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –¥–≤–∏–≥–∞—Ç—å—Å—è –ø–æ —Ñ–∞–∑–∞–º:**
   - –ö–∞–∂–¥–∞—è —Ñ–∞–∑–∞ = –æ—Ç–¥–µ–ª—å–Ω—ã–π commit
   - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–π —Ñ–∞–∑—ã
   - Code review –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —á–∞—Å—Ç–µ–π

4. **–§–∏–Ω–∞–ª—å–Ω—ã–π merge:**
   - –ü–æ—Å–ª–µ –ø–æ–ª–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
   - –î–µ–ø–ª–æ–π –≤ production
   - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–µ—Ä–≤—ã–µ 48 —á–∞—Å–æ–≤

---

## üìù –ß–ï–ö–õ–ò–°–¢ –ì–û–¢–û–í–ù–û–°–¢–ò –ö –î–ï–ü–õ–û–Æ

- [ ] –í—Å–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã
- [ ] Unit —Ç–µ—Å—Ç—ã –ø–æ–∫—Ä—ã–≤–∞—é—Ç –∫–ª—é—á–µ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª (>80%)
- [ ] Integration —Ç–µ—Å—Ç—ã –ø—Ä–æ—à–ª–∏ —É—Å–ø–µ—à–Ω–æ
- [ ] Manual —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –∞—Ä—Ç–∏–∫—É–ª–∞—Ö OZON
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞ (README, API docs)
- [ ] Code review –ø—Ä–æ–π–¥–µ–Ω
- [ ] –ù–µ—Ç –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –±–∞–≥–æ–≤ –≤ —Ç—Ä–µ–∫–µ—Ä–µ
- [ ] Backup –ë–î –ø–µ—Ä–µ–¥ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º –º–∏–≥—Ä–∞—Ü–∏–∏
- [ ] Rollback –ø–ª–∞–Ω –≥–æ—Ç–æ–≤ (–Ω–∞ —Å–ª—É—á–∞–π –ø—Ä–æ–±–ª–µ–º)
- [ ] –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–∞—Å—Ç—Ä–æ–µ–Ω (–ª–æ–≥–∏, –∞–ª–µ—Ä—Ç—ã)

---

## üîó –°–í–Ø–ó–ê–ù–ù–´–ï –î–û–ö–£–ú–ï–ù–¢–´

- [PRD.md](./PRD.md) - Product Requirements Document (–æ–±–Ω–æ–≤–∏—Ç—å –ø–æ—Å–ª–µ –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏–∏)
- [IMPLEMENTATION_SUMMARY.md](./IMPLEMENTATION_SUMMARY.md) - —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏ (–¥–æ–±–∞–≤–∏—Ç—å —Ä–∞–∑–¥–µ–ª –æ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏)
- [DEPLOY_CHECKLIST.md](./DEPLOY_CHECKLIST.md) - —á–µ–∫–ª–∏—Å—Ç –¥–µ–ø–ª–æ—è
- [API Documentation](http://backend:8000/docs) - Swagger docs (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–∏—Ç—Å—è)

---

## ‚ùì –í–û–ü–†–û–°–´ –ò –†–ï–®–ï–ù–ò–Ø

### Q: –ü–æ—á–µ–º—É article_groups –≤–º–µ—Å—Ç–æ competitor_article_number –≤ articles?
**A:** –ì–∏–±–∫–æ—Å—Ç—å –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å. –ú–æ–∂–Ω–æ –±—É–¥–µ—Ç —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å 3+ –∞—Ä—Ç–∏–∫—É–ª–æ–≤, —Å–æ–∑–¥–∞–≤–∞—Ç—å –≥—Ä—É–ø–ø—ã "–≤–∞—Ä–∏–∞–Ω—Ç—ã —Ç–æ–≤–∞—Ä–∞", "–ø–æ—Ö–æ–∂–∏–µ —Ç–æ–≤–∞—Ä—ã" –∏ —Ç.–¥.

### Q: –ù—É–∂–Ω–æ –ª–∏ —Ö—Ä–∞–Ω–∏—Ç—å —Å–Ω—ç–ø—à–æ—Ç—ã –∏–ª–∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ price_history?
**A:** –°–Ω—ç–ø—à–æ—Ç—ã –Ω—É–∂–Ω—ã, –ø–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç **–ø–æ–ª–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è** –≤ –º–æ–º–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏, –≤–∫–ª—é—á–∞—è –º–µ—Ç—Ä–∏–∫–∏, –∏–Ω–¥–µ–∫—Å, —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏. Price_history —Ç–æ–ª—å–∫–æ –¥–ª—è —Ü–µ–Ω.

### Q: –ö–∞–∫ –±—ã—Ç—å —Å–æ —Å—Ç–∞—Ä—ã–º–∏ –∞—Ä—Ç–∏–∫—É–ª–∞–º–∏ –±–µ–∑ –≥—Ä—É–ø–ø?
**A:** –û–Ω–∏ –ø—Ä–æ–¥–æ–ª–∂–∞—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∫–∞–∫ –µ—Å—Ç—å. –ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è - –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è. –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é —Å—Ç–∞—Ä—ã—Ö –∞—Ä—Ç–∏–∫—É–ª–æ–≤ –≤ –±—É–¥—É—â–µ–º.

### Q: –ß—Ç–æ –µ—Å–ª–∏ scraping –æ–¥–Ω–æ–≥–æ –∏–∑ –∞—Ä—Ç–∏–∫—É–ª–æ–≤ –Ω–µ —É–¥–∞–ª—Å—è?
**A:** –ü–æ–∫–∞–∑–∞—Ç—å —á–∞—Å—Ç–∏—á–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –ø–æ–º–µ—Ç–∫–æ–π "–î–∞–Ω–Ω—ã–µ –Ω–µ –¥–æ—Å—Ç—É–ø–Ω—ã" –¥–ª—è –ø—Ä–æ–±–ª–µ–º–Ω–æ–≥–æ –∞—Ä—Ç–∏–∫—É–ª–∞. –ò–ª–∏ –ø–æ–ø—Ä–æ—Å–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –ø–æ–∑–∂–µ.

---

**–ì–æ—Ç–æ–≤ –∫ –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏–∏!** üöÄ

_–°–æ–∑–¥–∞–Ω–æ: 2025-10-29_
_–ê–≤—Ç–æ—Ä: Claude Code_
_–°—Ç–∞—Ç—É—Å: –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ_
