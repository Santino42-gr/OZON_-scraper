# üî• –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï v3 - –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π URL

## –ü—Ä–æ–±–ª–µ–º–∞

–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è v2 —Å —É–ª—É—á—à–µ–Ω–Ω–æ–π anti-detection –∑–∞—â–∏—Ç–æ–π **–≤—Å—ë —Ä–∞–≤–Ω–æ –ø–æ–ª—É—á–∞–ª–∏ 403**:

```
üåê Scraping 1066650955 via Playwright: https://www.ozon.ru/search/?text=1066650955
‚ö†Ô∏è  HTTP 403 for 1066650955
‚ùå Playwright scraping failed for 1066650955: 403 Forbidden
```

## –ü—Ä–∏—á–∏–Ω–∞

**–ú—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –ù–ï–ü–†–ê–í–ò–õ–¨–ù–´–ô URL!**

### ‚ùå –ë—ã–ª–æ (—Å—Ç—Ä–æ–∫–∞ 406):
```python
return f"{self.base_url}/search/?text={quote(article)}"
# –†–µ–∑—É–ª—å—Ç–∞—Ç: https://www.ozon.ru/search/?text=1066650955
```

**–ü—Ä–æ–±–ª–µ–º–∞:** `/search/` - —ç—Ç–æ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ **–ø–æ–∏—Å–∫–∞**, —É –Ω–µ—ë:
- –ë–æ–ª–µ–µ –∂–µ—Å—Ç–∫–∞—è –∑–∞—â–∏—Ç–∞ –æ—Ç –±–æ—Ç–æ–≤
- –ü–æ—Å—Ç–æ—è–Ω–Ω—ã–µ 403 –¥–∞–∂–µ —Å Playwright
- –¢—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–∏—Å–∫–∞

### ‚úÖ –°—Ç–∞–ª–æ (—Å—Ç—Ä–æ–∫–∞ 408):
```python
return f"{self.base_url}/product/{article}/"
# –†–µ–∑—É–ª—å—Ç–∞—Ç: https://www.ozon.ru/product/1066650955/
```

**–†–µ—à–µ–Ω–∏–µ:** `/product/` - —ç—Ç–æ –ø—Ä—è–º–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ **—Ç–æ–≤–∞—Ä–∞**:
- –ú–µ–Ω—å—à–µ –∑–∞—â–∏—Ç—ã –æ—Ç –±–æ—Ç–æ–≤
- –ü—Ä–æ—â–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ HTML
- –ë—ã—Å—Ç—Ä–µ–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è
- –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã (`h1`, `[data-widget='webPrice']`)

---

## –ü–æ—á–µ–º—É –º—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ /search/?

**–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞:** –ò–∑–Ω–∞—á–∞–ª—å–Ω–æ –∫–æ–¥ –±—ã–ª –Ω–∞–ø–∏—Å–∞–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å **–ø–æ–∏—Å–∫–æ–≤—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏** (keywords), –∞ –Ω–µ —Å –∞—Ä—Ç–∏–∫—É–ª–∞–º–∏.

Telegram –±–æ—Ç —Ç–æ–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `/search/`, –Ω–æ:
1. –û–Ω **–∏—â–µ—Ç –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º** ("–Ω–æ—É—Ç–±—É–∫", "–∫—Ä–µ–º –¥–ª—è –ª–∏—Ü–∞")
2. –ü–æ—Ç–æ–º **–∏–∑–≤–ª–µ–∫–∞–µ—Ç —Å—Å—ã–ª–∫–∏** –Ω–∞ —Ç–æ–≤–∞—Ä—ã –∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
3. –ò —Ç–æ–ª—å–∫–æ –ø–æ—Ç–æ–º **–ø–µ—Ä–µ—Ö–æ–¥–∏—Ç** –Ω–∞ `/product/...`

–ú—ã –∂–µ —Å—Ä–∞–∑—É –∑–Ω–∞–µ–º –∞—Ä—Ç–∏–∫—É–ª! –ó–∞—á–µ–º –Ω–∞–º search?

---

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

### –§–∞–π–ª: `backend/services/ozon_scraper.py`

**–°—Ç—Ä–æ–∫–∏ 405-408:**
```python
# –ö–†–ò–¢–ò–ß–ù–û: –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä—è–º—É—é —Å—Å—ã–ª–∫—É –Ω–∞ —Ç–æ–≤–∞—Ä, –∞ –Ω–µ search
# /search/ –∏–º–µ–µ—Ç –±–æ–ª–µ–µ –∂–µ—Å—Ç–∫—É—é –∑–∞—â–∏—Ç—É –æ—Ç –±–æ—Ç–æ–≤ (403)
# /product/ –±–æ–ª–µ–µ –¥–æ—Å—Ç—É–ø–Ω–∞ –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø–∞—Ä—Å–∏—Ç—Å—è
return f"{self.base_url}/product/{article}/"
```

---

## –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

### –î–æ (v2):
```
‚Üí https://www.ozon.ru/search/?text=1066650955
‚Üê HTTP 403 Forbidden ‚ùå
```

### –ü–æ—Å–ª–µ (v3):
```
‚Üí https://www.ozon.ru/product/1066650955/
‚Üê HTTP 200 OK ‚úÖ
‚úÖ Page loaded, found selector: h1
üí∞ –¶–µ–Ω–∞: XXX ‚ÇΩ
```

---

## –î–µ–ø–ª–æ–π v3

### 1. –ö–æ–º–∞–Ω–¥–∞:
```bash
./redeploy.sh
```

–∏–ª–∏ –≤—Ä—É—á–Ω—É—é:
```bash
docker-compose -f docker-compose.prod.yml down
docker-compose -f docker-compose.prod.yml build --no-cache
docker-compose -f docker-compose.prod.yml up -d
```

### 2. –¢–µ—Å—Ç:
–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∞—Ä—Ç–∏–∫—É–ª `1066650955` —á–µ—Ä–µ–∑ Telegram –±–æ—Ç–∞.

### 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏:
```bash
docker-compose -f docker-compose.prod.yml logs -f backend
```

–î–æ–ª–∂–Ω–æ –±—ã—Ç—å:
```
üåê Scraping 1066650955 via Playwright: https://www.ozon.ru/product/1066650955/
‚úÖ Page loaded, found selector: h1
‚úÖ –£—Å–ø–µ—à–Ω–æ –ø–æ–ª—É—á–µ–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–æ–≤–∞—Ä–µ
```

---

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Å–ø—Ä–∞–≤–∫–∞

### URL —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ OZON:

| URL | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –ó–∞—â–∏—Ç–∞ | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ |
|-----|-----------|--------|---------------|
| `/search/?text=...` | –ü–æ–∏—Å–∫ –ø–æ keywords | **–ñ–µ—Å—Ç–∫–∞—è** | –¢–æ–ª—å–∫–æ –¥–ª—è keywords |
| `/product/ARTICLE/` | –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Ç–æ–≤–∞—Ä–∞ | –°—Ä–µ–¥–Ω—è—è | **–î–ª—è –∞—Ä—Ç–∏–∫—É–ª–æ–≤** ‚≠ê |
| `/product/name-ARTICLE/` | SEO URL —Ç–æ–≤–∞—Ä–∞ | –°—Ä–µ–¥–Ω—è—è | –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ |

### –ü–æ—á–µ–º—É /product/ –ª—É—á—à–µ:

1. **–ú–µ–Ω—å—à–µ –∑–∞—â–∏—Ç—ã:** OZON –Ω–µ –æ–∂–∏–¥–∞–µ—Ç –±–æ—Ç–æ–≤ –Ω–∞ –ø—Ä—è–º—ã—Ö —Å—Å—ã–ª–∫–∞—Ö
2. **–ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã:** `h1`, `[data-widget='webPrice']` –µ—Å—Ç—å –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ —Ç–æ–≤–∞—Ä–∞
3. **–ë—ã—Å—Ç—Ä–µ–µ:** –ù–µ –Ω—É–∂–Ω–æ –∂–¥–∞—Ç—å —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–∏—Å–∫–∞
4. **–°—Ç–∞–±–∏–ª—å–Ω–µ–µ:** –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Ç–æ–≤–∞—Ä–∞ –±–æ–ª–µ–µ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–∞

---

## –ò—Å—Ç–æ—Ä–∏—è –≤–µ—Ä—Å–∏–π

### v1 (–ø–µ—Ä–≤–∞—è –ø–æ–ø—ã—Ç–∫–∞)
- ‚ùå URL: `/search/?text=...`
- ‚ùå Anti-detection: –±–∞–∑–æ–≤–∞—è
- ‚ùå –†–µ–∑—É–ª—å—Ç–∞—Ç: 403

### v2 (—É–ª—É—á—à–µ–Ω–Ω–∞—è anti-detection)
- ‚ùå URL: `/search/?text=...` (–æ—à–∏–±–∫–∞ –æ—Å—Ç–∞–ª–∞—Å—å!)
- ‚úÖ Anti-detection: —É—Å–∏–ª–µ–Ω–Ω–∞—è (–∑–∞–¥–µ—Ä–∂–∫–∏, —Å–µ–ª–µ–∫—Ç–æ—Ä—ã)
- ‚ùå –†–µ–∑—É–ª—å—Ç–∞—Ç: –≤—Å—ë —Ä–∞–≤–Ω–æ 403

### v3 (—Ç–µ–∫—É—â–∞—è - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω URL)
- ‚úÖ URL: `/product/...` **–ö–†–ò–¢–ò–ß–ù–û**
- ‚úÖ Anti-detection: —É—Å–∏–ª–µ–Ω–Ω–∞—è
- ‚úÖ –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: 200 OK

---

## –í—ã–≤–æ–¥

**–ì–ª–∞–≤–Ω—ã–π —É—Ä–æ–∫:** –î–∞–∂–µ –∏–¥–µ–∞–ª—å–Ω–∞—è anti-detection –∑–∞—â–∏—Ç–∞ –Ω–µ –ø–æ–º–æ–∂–µ—Ç, –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π URL!

`/search/` - –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º
`/product/` - –¥–ª—è –∞—Ä—Ç–∏–∫—É–ª–æ–≤ ‚≠ê

---

**–≠—Ç–æ –±—ã–ª –ø–æ—Å–ª–µ–¥–Ω–∏–π –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–π –∫—É—Å–æ—á–µ–∫ –ø–∞–∑–∑–ª–∞! v3 –¥–æ–ª–∂–Ω–∞ –∑–∞—Ä–∞–±–æ—Ç–∞—Ç—å. üöÄ**
